---
title: "Project 1 PHP 2550 Final"
output:
  pdf_document: default
  html_document: default
date: "2023-10-08"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars}
summary(cars)
# load the packages
library(tidyverse)
library(dplyr)
library(kableExtra)
library(gtsummary)
library(ggplot2)
library(naniar)
library(gridExtra)

# load the data
new_df<- read.csv("C:/Users/VGSCHOOL/project1.csv")

```

## Including Plots

You can also embed plots, for example:
Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.

```{r pressure, echo=FALSE}
plot(pressure)

#Create NA values for missingness in smoking during pregnancy and post partum variables
new_df[,c(22:28)]<-lapply(new_df[,c (22:28)],function(x) ifelse(x=="",NA,x))

# factorize the categorical data
new_df<-new_df %>%
  mutate_if(is.character,factor)

new_df[,c(3:13)]<- new_df[,c(3:13)] %>%
mutate_if(is.numeric, factor) 

new_df[,c(53:61)]<- new_df[,c(53:61)] %>%
mutate_if(is.numeric, factor) 

new_df[,c(37:42)]<- new_df[,c(37:42)] %>%
mutate_if(is.numeric, factor) 

#Remove Outliers in Dataset in which we have viewed and change to standardize them with rest of data

new_df$mom_numcig <- as.character(new_df$mom_numcig)

new_df$mom_numcig <- ifelse(new_df$mom_numcig == "None", "0", new_df$mom_numcig )
new_df$mom_numcig <- ifelse(new_df$mom_numcig == "2 black and miles a day", "2",new_df$mom_numcig)

#average 20-25 
new_df$mom_numcig <- ifelse(new_df$mom_numcig == "20-25","22.5",new_df$mom_numcig)
#change 44989 to NA
new_df$mom_numcig <- ifelse(new_df$mom_numcig == "44989",NA,new_df$mom_numcig)

#Remove comma to standardize to rest of values
new_df$income<- as.character(new_df$income)
new_df$income<- ifelse(new_df$income == "250,000", "250000", new_df$income )

#Change 0 values to NA for Swan scores in data 
new_df$swan_inattentive<- ifelse(new_df$swan_inattentive == 0,NA,new_df$swan_inattentive)
new_df$swan_hyperactive<- ifelse(new_df$swan_hyperactive == 0,NA,new_df$swan_hyperactive)

#Change number of cigs  and income into numeric values 
new_df$mom_numcig<-as.numeric(new_df$mom_numcig)
new_df$income<-as.numeric(new_df$income)



#If child answered no to consuming substances in the ever variables than put 0 as the value instead of NA
new_df$num_cigs_30 <- ifelse(new_df$cig_ever == 0, 0, new_df$num_cigs_30)
new_df$num_alc_30 <- ifelse(new_df$alc_ever == 0, 0, new_df$num_alc_30)
new_df$num_mj_30 <- ifelse(new_df$mj_ever == 0, 0, new_df$num_mj_30)
new_df$num_e_cigs_30 <- ifelse(new_df$e_cig_ever == 0, 0, new_df$num_e_cigs_30)


```
There are 78 variables from 49 participants representing the demographics, socioeconomic status, education, and score measurements from survey of parent and child focusing on externalizing, self-regulation, and substance use. The variables also included smoking status during pre and postpartum (SDP) and follow up measurements on Environmental tobacco smoke (ETS) within a five year period after the child's birth.


First, I wanted to reformat the data to get rid of any outliers or missinginess that might create bias or skewed results. I first factored race, sex, education, income, and time to look at baseline characteristics.  I found that there is one row with mostly NA values for measurements so I proceeded to delete this row. Then,  I factored the time variables for smoking status at all time points. I continued checking the data for any outliers that may be included and they were multiple in the mom_numcig. I believed that there was an error in the data when it said a patient smokes 44,989 cigarettes in one day so I replaced the value with NA for missing so it wouldn't skew our results ,and changed two strings to integers "2 black and miles a day" and "none".I also added in NA values to  columns in the SDP time variables and changed the NA values to 0 if the child answered that they had never consumed a substance before to account for it  correctly in the missing data patterns in which will be conducted in the next step. In addition, I also changed the O values in swan_inattentive and swan_hyperactive to NA values as they were in the original dataset. 
```{r}
overall_missing<-miss_var_summary(new_df)
overall_missing


 #Look at missing data for each parent 
pct_na_r <- rowSums(is.na(new_df)) / ncol(new_df) * 100
row_na <- data.frame(parent_id = new_df$parent_id, pct_na = pct_na_r)
row_na <- row_na[row_na$pct_na > 70,] 
print(row_na) 

#Remove row with baseline values missing
row_to_remove <- 38 
new_df <- new_df[-row_to_remove, ]


#Create imputation for smoking status for post-partum and during pregnancy
new_df$mom_smoke_32wk<- ifelse(new_df$mom_smoke_16wk == "1=Yes" & 
                                 new_df$mom_smoke_22wk == "1=Yes",
                  "1=Yes", as.character(new_df$mom_smoke_32wk) )

new_df$mom_smoke_32wk<-factor(new_df$mom_smoke_32wk)

new_df$mom_smoke_pp1<- ifelse(new_df$mom_smoke_22wk == "1=Yes" & 
                               new_df$mom_smoke_32wk == "1=Yes" &
                               new_df$mom_smoke_pp2 == "1=Yes",
                  "1=Yes", as.character(new_df$mom_smoke_pp1))
new_df$mom_smoke_pp1<-factor(new_df$mom_smoke_pp1)

```
Second, we would like to look at missing data patterns in baseline characteristics, SDP time variables, ETS time variables,score responses from survey, and across patients in general. There was an extraordinary amount of missing data all across the dataset but the highest variables of missingnesss were mom_smoke_pp1(79.59)% , childasd (57.14%), and mom_smoke_pp2(40.81%). The other smoking time variables for SDP and ETS all had missing percentages ranging from 22.45% to 14.29%. Furthermore,considering the cumulative nature of cigarette smoking and the nicotine addictive, I addressed this data gap by making the following assumptions. I assumed that if a parent's smoking behavior was known at 16 and 22 weeks, this behavior would remain consistent at 32 weeks (consistency of the addictive drug). Similarly, if we had information on a parent's smoking behavior at 22 and 32 weeks, as well as at postpartum visit 2, we assumed that this behavior would continue into postpartum visit 1. Although since there was a lot of missing data with the postpartum visits 1 & 2 and its not an accurate time point in which these visits occurred (such as 12weeks and 6 months ) in the timeline so I have excluded them from my  analysis when referring to post-partum smoking status and only focus on mom_smoke_pp12wk and mom_smoke_pp6mo which both have more complete data and time points for measurement.

The parental knowledge questions answered by the child had yielded high percentages of missingness around 28.5% to 26.5% and an assumption of lack of knowledge due to perspective of not being a parent/adult could account for these percentages. However, it's important to note that we refrained from making assumptions about environmental tobacco smoke (ETS) exposure variables, as they were subject to more frequent fluctuations compared to parental smoking behavior.

You can see across patients that there are 9 patients with missing data over 70%!!! Usually if we had a larger dataset we would probably remove all 9 patients but due to us having 49 patients I have decided to keep 8 out of 9 for the analysis. I have removed parent id 53902 because it has missingness in the baseline for SDP(mom_smoke_16wk). If a patient doesn't have baseline measurements it can cause a multitude of problems including bias, reduced statistical power, inaccurate estimates, and more. To avoid this you can use imputation or perform a sensitivity analysis but I believed it would just be best to do a complete case analysis. Below I have created tables showing the reformatted data and the baseline characteristics mean values, count, and missing values count. 

```{r}
table1_SDP<-new_df %>% select(mom_smoke_16wk,mom_smoke_22wk, mom_smoke_32wk) %>%
tbl_summary(missing_text = "Missing") %>%
knitr::kable(caption = "Table 1:Summary of SDP",

col.names = c("SDP characteristics","#")) 

table1_SDP

table2_PP<-new_df %>% select(mom_smoke_pp12wk,mom_smoke_pp6mo) %>%
tbl_summary(missing_text = "Missing") %>%
knitr::kable(caption = "Table 2:Summary of Post-Partum",

col.names = c("Smoking PP characteristics","#")) 
table2_PP

table_ETS<-new_df %>% select(smoke_exposure_12mo,smoke_exposure_12mo,smoke_exposure_2yr,smoke_exposure_3yr,
                             smoke_exposure_4yr,smoke_exposure_5yr) %>%
tbl_summary(missing_text = "Missing") %>%
knitr::kable(caption = "Table 3:Summary of ETS",

col.names = c("Smoking Follow-Up characteristics","#")) 
table_ETS


```




```{r}
#Find average composite score of follow up
new_df$avg_smoke_follow<-((rowSums(new_df[,c("smoke_exposure_6mo","smoke_exposure_12mo")] ==1,
                                    na.rm=T))/2
                           +(rowSums(new_df[,c("smoke_exposure_2yr","smoke_exposure_3yr",
                                               "smoke_exposure_4yr","smoke_exposure_5yr")] ==1,
                                           na.rm= T)))/5

new_df$cum_smoke_pp<-(rowSums(new_df[,c("mom_smoke_pp12wk","mom_smoke_pp6mo")]=="1=Yes",na.rm=T))

#Find cumulative score of SDP
new_df$cum_smoke_preg<-rowSums(new_df[,c("mom_smoke_16wk",
                            "mom_smoke_22wk", 
                            "mom_smoke_32wk")] == "1=Yes", na.rm = T)
```

Next, I created composite scores for the SDP and post-partum smoking and average scores for follow up ETS smoking variables to simplify the data since they are measuring the same attribute of smoking status during these different points.  

TIME TO ADDRESS THE AIMS:
AIM 1: Examine effects of SDP/ETS on adolescent self-regulation, substance use, and externalizing.

```{r}
#fit new model using cumulative count with alcohol use 


model_cum_smoke_alc<- glm(alc_ever ~ cum_smoke_preg, data = new_df, family = binomial(link = "logit"))
summary(model_cum_smoke_alc)

#create plot showing the probability predictions 
new_cum_data <- data.frame(cum_smoke_preg = new_df$cum_smoke_preg)

# Predict probabilities using the model
new_cum_data$Predicted_Probabilities<- predict(model_cum_smoke_alc, newdata = new_cum_data, type = "response")


# Create a plot for baseline and alcohol use predictions
alc_plot<-ggplot(data = new_cum_data, aes(x = cum_smoke_preg, y = Predicted_Probabilities)) +
  geom_line() +
  labs(
    x = "Maternal Smoking Status Cumulative",
    y = "Predicted Probabilities of Child Alcohol Use",
    title = "Graph 1: Logistic Regression Predicted Probabilities"
  )
```

```{r}
#fit new model using cumulative count with marijuana use 
model_cum_smoke_mj<- glm(mj_ever ~ cum_smoke_preg, data = new_df, family = binomial(link = "logit"))
summary(model_cum_smoke_mj)

#create plot showing the probability predictions 
new_cum_data_mj<- data.frame(cum_smoke_preg = new_df$cum_smoke_preg)

# Predict probabilities using the model
new_cum_data_mj$Predicted_Probabilities<- predict(model_cum_smoke_mj, newdata = new_cum_data_mj, type = "response")


# Create a plot for baseline and alcohol use predictions
mj_plot<-ggplot(data = new_cum_data_mj, aes(x = cum_smoke_preg, y = Predicted_Probabilities)) +
  geom_line() +
  labs(
    x = "Maternal Smoking Status Cumulative",
    y = "Predicted Probabilities of Child Marijuana Use",
    title = "Graph 2: Logistic Regression Predicted Probabilities"
  )
```

```{r}
#fit new model using cumulative count with ecig use 
model_cum_smoke_ecig<- glm(e_cig_ever ~ cum_smoke_preg, data = new_df, family = binomial(link = "logit"))
summary(model_cum_smoke_ecig)

#create plot showing the probability predictions 
new_cum_data_ecig<- data.frame(cum_smoke_preg = new_df$cum_smoke_preg)

# Predict probabilities using the model
new_cum_data_ecig$Predicted_Probabilities<- predict(model_cum_smoke_ecig, newdata = new_cum_data_ecig, type = "response")


# Create a plot for baseline and alcohol use predictions
ecig_plot<-ggplot(data = new_cum_data_ecig, aes(x = cum_smoke_preg, y = Predicted_Probabilities)) +
  geom_line() +
  labs(
    x = "Maternal Smoking Status Cumulative",
    y = "Predicted Probabilities of Child E-cigarette Use",
    title = "Graph 3:Logistic Regression Predicted Probabilities"
  )
#fit new model using cumulative count with cigarette use 

model_cum_smoke_cig<- glm(cig_ever ~ cum_smoke_preg, data = new_df, family = binomial(link = "logit"))
summary(model_cum_smoke_cig)

#create plot showing the probability predictions 
new_cum_data_cig<- data.frame(cum_smoke_preg = new_df$cum_smoke_preg)

# Predict probabilities using the model
new_cum_data_cig$Predicted_Probabilities<- predict(model_cum_smoke_cig, newdata = new_cum_data_cig, type = "response")


# Create a plot for baseline and alcohol use predictions
cig_plot<-ggplot(data = new_cum_data_cig, aes(x = cum_smoke_preg, y = Predicted_Probabilities)) +
  geom_line() +
  labs(
    x = "Maternal Smoking Status Cumulative",
    y = "Predicted Probabilities of Child cigarette Use",
    title = "Graph 4: Logistic Regression Predicted Probabilities"
)
grid.arrange(alc_plot, mj_plot, ecig_plot, heights = c(4,4,4))
```

First, I looked at the effects of SPD/ ETS on substance use in adolescents.I decided to look at the SDP and substance use effects using a GLM model because the presence of outliers or data that does not conform to normality assumptions. Also, GLMs allow for the modeling of nonlinear relationships between predictor variables and the response, making them versatile in capturing complex associations in the data. We see in the GLM models for SDP that for mj_ever,alc_ever, and ecig_ever that the baseline risk, was statistically significant (p = 0.00124,p=0.000472, p=0.000595 ), indicating that the likelihood of the three variables was significantly different from zero when no other predictor variables were considered. However, the cumulative score of SDP shows to possibly not be significant on substance use for children. The intercept was not significant for cig_ever.

So for next steps I think it would best and more appropriate to look at effects through summary tables instead of GLMs because the statistics can help you identify potential issues, such as skewness, outliers, or heteroscedasticity,to examine the assumptions underlying those models more before applying it. With making this next transition I evaluated the ETS follow-up on substance use on adolescents.
```{r}
new_df %>% select(avg_smoke_follow, alc_ever, cig_ever, e_cig_ever,

mj_ever, num_cigs_30, num_e_cigs_30, num_mj_30,num_alc_30) %>%

tbl_summary( by = avg_smoke_follow, missing_text = "Missing",
type = list (c(alc_ever, cig_ever, e_cig_ever,mj_ever, num_cigs_30, num_e_cigs_30, num_mj_30,num_alc_30) ~ "continuous",
c(avg_smoke_follow) ~ "categorical"),
statistic = all_continuous() ~ "{mean} ({sd})",
digits = list(c(alc_ever, cig_ever, e_cig_ever,mj_ever, num_cigs_30, num_e_cigs_30, num_mj_30,num_alc_30) ~ c(2, 2))) %>%
add_p(all_categorical () ~ "chisq.test", pvalue_fun = ~ style_pvalue(.x, digits = 2))

```
This summary table displays the effects of the average follow up ETS on the substance use variables. We see that none of the variables alc-ever,cig_ever, e_cig_ever, mj_ever, num_cigs_30, num_e_cigs_30, num_mj_30, num_alc_30, for the children showed any statistical significance with the exposed tobacco smoke in their early years of childhood. We can see that there is a lot of missingness once again and that most people have an average score of 0 for the follow-up. There was a lot of variation in the the data 
```{r}
#stratified by cum SDP
tbl1_swan<- new_df[,c(32,33,81)] %>%
  tbl_summary(by = cum_smoke_preg) %>%
  add_p() %>%
  sort_p() %>%
  modify_caption("Compare Externalizing Swan factor score with SDP") 
as_kable_extra(tbl1_swan)%>% 
  kable_styling(full_width=T, latex_options = c('HOLD_position'))


tbl1_erq<- new_df[,c(73,74,81)] %>%
  tbl_summary(by = cum_smoke_preg) %>%
  add_p() %>%
  sort_p() %>%
  modify_caption("Compare Externalizing ERQ factors score with SDP") 
as_kable_extra(tbl1_erq)%>% 
  kable_styling(full_width=T, latex_options = c('HOLD_position'))


new_df %>% select(cum_smoke_preg, bpm_att, bpm_att_p, bpm_ext,

bpm_ext_p, bpm_int, bpm_int_p) %>%

tbl_summary( by = cum_smoke_preg, missing_text = "Missing",
type = list (c(bpm_att, bpm_ext, bpm_int,
bpm_att_p, bpm_ext_p, bpm_int_p) ~ "continuous",
c(cum_smoke_preg) ~ "categorical"),
statistic = all_continuous() ~ "{mean} ({sd})",
digits = list(c(bpm_att, bpm_ext, bpm_int,
bpm_att_p, bpm_ext_p, bpm_int_p) ~ c(2, 2))) %>%
add_p(all_categorical () ~ "chisq.test", pvalue_fun = ~ style_pvalue(.x, digits = 2))
```
First we look at the statistics from the swan inattentive and swan hyperactive variable. It shows the median score and its confidence interval For example, where the cumulative SDP is 1 for swan hyperactive we see the median is 12 with a narrow CI with a lower bound of 9 and upper bound of 13. We see that for the hyperactive variable that Cumulative SDP for 0 has a wider range between 4,1 with a median of 5 and cumulative score 3 has an even wider interval from 6 to 19 with a median of 15.The p-value for the comparison is 0.14, suggests that there is no statistically significant difference in the "swan_hyperactive" variable between the three SDP groups. For swan inattentive the p-value as well did not prove statistical significance  with a p-value of 0.2 and the different medians and confidence intervals can be seen in the summary table above.

I then observed the Emotion Regulation Questionairre responses between the cumulative SDP and erq_exp did have a small p-value (0.081) but still proved not to be significant.Where the cumulative SDP is 1 for erq_exp we see the median is 3.25 with a narrow CI with a lower bound of the median value 3.25 and upper bound of 3.88. We see that for the erq_exp variable that Cumulative SDP for 0 has a wider range between 2,3 with a median of 2.5. The erq_cog had a higher p-value that proved not to be significant as well of 0.5.


For the Brief Problem Monitor responses none of the variables showed significance with the Cumulative SDP but I do want to highlight the small p-value variables which are bpm_att and bpm_att_p. Bpm_int had the most missingness between all the variables and in the last table you will be able to see each of the confidence intervals broken down between the SDP cum scores and their confidence intervals. 

```{r}
#stratified by cum PP
tbl2_swan<- new_df[,c(32,33,80)] %>%
  tbl_summary(by = cum_smoke_pp) %>%
  add_p() %>%
  sort_p() %>%
  modify_caption("Compare Externalizing Swan factor score with PP") 
as_kable_extra(tbl2_swan)%>% 
  kable_styling(full_width=T, latex_options = c('HOLD_position'))


tbl2_erq<- new_df[,c(73,74,80)] %>%
  tbl_summary(by = cum_smoke_pp) %>%
  add_p() %>%
  sort_p() %>%
  modify_caption("Compare Externalizing ERQ factors score with PP") 
as_kable_extra(tbl2_erq)%>% 
  kable_styling(full_width=T, latex_options = c('HOLD_position'))


new_df %>% select(cum_smoke_pp, bpm_att, bpm_att_p, bpm_ext,

bpm_ext_p, bpm_int, bpm_int_p) %>%

tbl_summary( by = cum_smoke_pp, missing_text = "Missing",
type = list (c(bpm_att, bpm_ext, bpm_int,
bpm_att_p, bpm_ext_p, bpm_int_p) ~ "continuous",
c(cum_smoke_pp) ~ "categorical"),
statistic = all_continuous() ~ "{mean} ({sd})",
digits = list(c(bpm_att, bpm_ext, bpm_int,
bpm_att_p, bpm_ext_p, bpm_int_p) ~ c(2, 2))) %>%
add_p(all_categorical () ~ "chisq.test", pvalue_fun = ~ style_pvalue(.x, digits = 2))
```
First we look at the statistics from the swan inattentive and swan hyperactive variable. It shows the median score and its confidence interval but this time we'll be evaluating these effects from the cumulative score from post-partum smoking.For swan inattentive  at cumulative score of 1 we see the median is 15 with a lower bound of 12 and upper bound of 17 We see that for the inattentive variable that Cumulative SPP for 0 has a range between 7and 12 with a median of 9 and cumulative score 2 has an even interval from 12 to 16 with a median of 14.The p-value is 0.083, suggests that there is no statistically significant difference in the "swan_inattentive" variable between the three SDP groups. For swan hyperactive the p-value as well did not prove statistical significance  with a p-value of 0.3 and the different medians and confidence intervals can be seen in the summary table above.

I then observed the Emotion Regulation Questionairre responses between the cumulative SPP and erq_exp and exp_cog had the same p-value of 0.3 and which suggested no statistical significance.Where the cumulative SPP is 1 for erq_exp we see the median is 2.50 with a narrow CI with a lower bound of the median value 2.00 and upper bound of 2.50. We see that for the erq_cog variable that Cumulative SPP for 0 has a wider range between 2.75,3.71 with a median of 3.08. 


For the Brief Problem Monitor responses only two  variables showed statistical significance which was bpm_ext_p with a p-value of 0.007 and bpm_int_p with a p-value of 0.043. With the Cumulative SPP I do want to highlight other the small but non-significant variables which are bpm_att and bpm_att_p.

```{r}
#stratified by average ETS
tbl3_swan<- new_df[,c(32,33,79)] %>%
  tbl_summary(by = avg_smoke_follow) %>%
  add_p() %>%
  sort_p() %>%
  modify_caption("Compare Externalizing Swan factor score with ETS") 
as_kable_extra(tbl3_swan)%>% 
  kable_styling(full_width=T, latex_options = c('HOLD_position'))


tbl3_erq<- new_df[,c(73,74,79)] %>%
  tbl_summary(by = avg_smoke_follow) %>%
  add_p() %>%
  sort_p() %>%
  modify_caption("Compare Externalizing ERQ factors score with ETS") 
as_kable_extra(tbl3_erq)%>% 
  kable_styling(full_width=T, latex_options = c('HOLD_position'))


new_df %>% select(avg_smoke_follow, bpm_att, bpm_att_p, bpm_ext,

bpm_ext_p, bpm_int, bpm_int_p) %>%

tbl_summary( by = avg_smoke_follow, missing_text = "Missing",
type = list (c(bpm_att, bpm_ext, bpm_int,
bpm_att_p, bpm_ext_p, bpm_int_p) ~ "continuous",
c(avg_smoke_follow) ~ "categorical"),
statistic = all_continuous() ~ "{mean} ({sd})",
digits = list(c(bpm_att, bpm_ext, bpm_int,
bpm_att_p, bpm_ext_p, bpm_int_p) ~ c(2, 2))) %>%
add_p(all_categorical () ~ "chisq.test", pvalue_fun = ~ style_pvalue(.x, digits = 2))
```
First we look at the statistics from the swan inattentive and swan hyperactive variable. It shows the median score and its confidence interval but this time we'll be evaluating these effects from the average ETS score from follow-up .For swan inattentive at avergae score of 0.1 we see the median is 13 with a lower bound of 10 and upper bound of 15. We see that for the inattentive variable that average ETS for 0 has a range between 7 and 13 with a median of 9 and average score 0.9 has an interval of (4,4) with a median of 4 since there is only one person to analyze.The p-value is 0.067, suggests that there is no statistically significant difference in the "swan_inattentive" variable between the average scores. For swan hyperactive the p-value as well did not prove statistical significance  with a p-value of 0.2 and the different medians and confidence intervals can be seen in the summary table above.

I then observed the Emotion Regulation Questionairre responses between the average ETS follow-up scores and erq_exp and exp_cog have non-sginificant p-value both greater than 0.13.Where the average ETS score is 1 for erq_exp we see the median is 3.75 with a narrow CI with a lower bound of the median value 3.50 and upper bound of 4.00. We see that for the erq_cog variable that average ETS score for 0 has a wider range between 2.58,4.00 with a median of 3.17. 


For the Brief Problem Monitor responses only none of the variables showed statistical significance but bpm_ext_p did also show statistical signifcance with a p-value of 0.054 .

In conclusion  with the effects of SDP and ETS on the  externalizing,substance use,and self-regulation variables there were not too many significant relationships we got results from. And  a lot of these variables could be significant or on the cusp to reflect how smoking during pregnancy or exposure to tobacco smoke can have an effect on increasing substance use and poorer self-regulation if there was more data available and less missingess answering HYP1A and HYP1b. 


```{r}
#Plots of Cotimean measurements
cotimean_box<-boxplot(cotimean_34wk ~ mom_smoke_32wk,
        data = new_df,
        main = "Box Plot of Parent Cotinine Levels by Smoking status in 32 weeks",
        xlab = "Smoking Status",
        ylab = "Cotinine Level",
        col = c("lightblue", "lightgreen", "lightpink"),
        border = "blue")

contimean_post<-plot(new_df$cotimean_pp6mo, new_df$cotimean_pp6mo_baby,
xlab = "Parent cotinine level 6 months post partum",
ylab = "Child cotinine level (6 mo. postpart.)")
```
I wanted to look at the distribution of the contimean score between the mothers smoking status in her last trimester. We see that when answered Yes for their smoking status there is more of range and a higher average  which would be predicted since continine does measure and test screens for nictoine which is present in the yes. This shows that the mothers answered truthfully about their smoking status in the last trimester. The same can be said for no with its small to none range and the couple of outliers in which can be accounted for fi they smoked recently prior to the testing in this last trimester of pregnancy.

The child continine levels at 6 months post-partum compared the mother's shows a high concentration at when the mother's measurement is 0 the child's is also 0. Even when the parents have high measurements of continine it is good to see that the tobacco screening is not reflected in child's urine meaning that it has not been passed onto the child. 


AIM 2: Explore links between self-regulation at baseline and substance and externalizing at 6- and 12-month follow-ups.

Aim 2 involves investigating the connections between self-regulation measured at the baseline and substance use as well as externalizing behavior at the 6- and 12-month follow-ups. Given that our dataset contains data exclusively from the baseline assessment, I want  to provide a overview of the baseline characteristics related to substance use, self-regulation, and externalizing behavior. Furthermore, I want to present a summary of these characteristics stratified by the cumulative (SDP) variable.


AIM3: Identify self-regulation problems that mediate the link between SDP/ETS exposure and level of, and change in, SU and EXT severity over time.
